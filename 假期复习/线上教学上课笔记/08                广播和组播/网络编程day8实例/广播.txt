///send.c
#include <sys/socket.h>
#include <arpa/inet.h>
#include <stdio.h>
int main()
{
	char buf[100] = { 0 };
	int fd = socket(AF_INET, SOCK_DGRAM, 0);
	struct sockaddr_in toaddr;
	toaddr.sin_family = AF_INET;
	toaddr.sin_port = htons(8888);
	toaddr.sin_addr.s_addr = inet_addr("192.168.30.255");
	int on = 1;   //1 表示允许广播， 0 不允许广播
	setsockopt(fd, SOL_SOCKET, SO_BROADCAST, &on, sizeof(on));
	scanf("%s", buf);
	sendto(fd, buf, sizeof(buf), 0, (struct sockaddr *)&toaddr, sizeof(toaddr));
}
////recv.c
#include <sys/socket.h>
#include <arpa/inet.h>
#include <stdio.h>
int main()
{
	char buf[100] = { 0 };
	int len = sizeof(struct sockaddr);
	struct sockaddr_in youaddr;
	int fd = socket(AF_INET, SOCK_DGRAM, 0);
	struct sockaddr_in myaddr;
	myaddr.sin_family = AF_INET;
	myaddr.sin_port = htons(8888);
	myaddr.sin_addr.s_addr = inet_addr("192.168.30.255");
	bind(fd, (struct sockaddr *)&myaddr, sizeof(myaddr));
	while(1)
	{
		recvfrom(fd, buf, sizeof(buf), 0, (struct sockaddr *)&youaddr, &len);
		printf("%s %s\n", inet_ntoa(youaddr.sin_addr),buf);
	}
}